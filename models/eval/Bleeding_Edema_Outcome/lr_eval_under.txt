2025-03-29 17:47:08.438 | INFO     | circ_milan.config:<module>:31 - PROJ_ROOT path is: /home/lshpaner/Python_Projects/circ_milan
[31m2025/03/29 17:47:10 WARNING mlflow.models.model: Model logged without a signature and input example. Please set `input_example` parameter when logging the model to auto infer the model signature.[0m
lr_under_training
lr_Bleeding_Edema_Outcome
Model Threshold Before Threshold Optimization: {'average_precision': 0.487}

 Best Threshold and Beta For Bleeding_Edema_Outcome: 

Could not find optimal threshold for the precision of 0.5
name 'y_valid' is not defined
Using Existing Experiment_ID: 132942270062857191
Found Run_ID: 621120ee88d3436780a5b7fd444969ef for run_name 'lr_under_training' in experiment 'Bleeding_Edema_Outcome_model'
Experiment_ID for model None and parameters: 132942270062857191
experiment_id=132942270062857191, run_id=621120ee88d3436780a5b7fd444969ef
Parameters and model logged successfully in MLflow.
Model Threshold After Threshold Optimization: {'average_precision': 0.487}
K-Fold

Detailed classification report for lr:

Confusion Matrix Across All 10 Folds for average_precision:
--------------------------------------------------------------------------------
          Predicted:
             Pos   Neg
--------------------------------------------------------------------------------
Actual: Pos  43 (tp)   15 (fn)
        Neg  16 (fp)  120 (tn)
--------------------------------------------------------------------------------

Classification Report Averaged Across All Folds for average_precision:
              precision    recall  f1-score   support

           0       0.89      0.88      0.89       136
           1       0.73      0.74      0.74        58

    accuracy                           0.84       194
   macro avg       0.81      0.81      0.81       194
weighted avg       0.84      0.84      0.84       194

--------------------------------------------------------------------------------
The model is trained on the full development set.
The scores are computed on the full evaluation set.

Optimal threshold used: 0.487

Running k-fold model metrics...

Processing Folds:   0%|          | 0/10 [00:00<?, ?it/s]Processing Folds:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 4/10 [00:00<00:00, 37.48it/s]Processing Folds:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 8/10 [00:00<00:00, 38.02it/s]Processing Folds: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:00<00:00, 38.28it/s]
2025-03-29 17:47:18.051 | SUCCESS  | __main__:main:155 - Modeling evaluation complete.

Average Metrics Across All Folds:
              Metric     Value
0      Precision/PPV  0.728814
1  Average Precision  0.817242
2        Sensitivity  0.741379
3        Specificity  0.882353
4            AUC ROC  0.901623
5        Brier Score  0.132343
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------

Empty DataFrame
Columns: [lr]
Index: []
Using Existing Experiment_ID: 132942270062857191
Found Run_ID: 621120ee88d3436780a5b7fd444969ef for run_name 'lr_under_training' in experiment 'Bleeding_Edema_Outcome_model'
